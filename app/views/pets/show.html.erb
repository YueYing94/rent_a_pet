<div class="container">
  <div class="pet-name">
    <h1><%= @pet.name %></h1>
  </div>
  <div class="pet-image">
    <%= cl_image_tag @pet.photo.key, height: 300, width: 400, crop: :fill %>
  </div>
  <div class="edit">
    <% if policy(@pet).edit? %>
      <%= link_to "Edit", edit_pet_path(@pet) %>
      <%= link_to "Delete", pet_path(@pet), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}  %>
    <% end %>
  </div>
  <div class="pet-owner">
   <h2> <%= @pet.user.first_name %></h2>
   <i class="fa-regular fa-user"></i>
  </div>
  <div class="owner-address">
   <p> <%= @pet.user.address %></p>
   <i class="fa-solid fa-location-dot"></i>
  </div>
  <p><%= @pet.description %></p>
</div>


<div class="container">
  <% if user_signed_in? %>
    <% if current_user != @pet.user %>
      <%= simple_form_for [@pet, @booking],  data: { controller: 'flatpickr', unavailable_dates: @pet.unavailable_dates.to_json } do |f| %>
        <%= f.input :start_date, as: :string, input_html: { type: 'date', data: { flatpickr_target: "startDate" }, class: "datepicker" } %>
        <%= f.input :end_date, as: :string, input_html: { type: 'date', data: { flatpickr_target: "endDate" }, class: "datepicker" } %>
        <%= f.submit "Book it!" %>
      <% end %>
    <% end %>
    <% else %>
      <div class="alert alert-dismissible fade show">
        <strong><i class="fa-solid fa-triangle-exclamation"></i></strong> You should log in to book it.
      </div>
    <% end %>
<div>
<div class="accordion dropdown" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        Reviews <i class="fa-solid fa-comment px-2"></i>
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
      <div class="accordion-body">

        <div class="py-4">
          <% if user_signed_in? %>
            <% if current_user != @pet.user %>
              <div>
                <h3>New Review</h3>
                <%= simple_form_for [@pet, @pet_review] do |f| %>
                <%= f.input :content %>
                <%= f.input :rating %>
                <%= f.submit "Submit review", class: "btn btn-success" %>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>

        <ul class="list-unstyled">
          <% @pet.pet_reviews.each do |review| %>
            <li class="py-2">
              <strong>Review:</strong> <%= review.content %><br>
              <strong>Rating:</strong> <%= review.rating %>
            </li>
          <% end %>
        </ul>


      </div>
    </div>
  </div>
</div>





  <% if user_signed_in? %>
    <% if current_user != @pet.user %>

    <div class="d-flex justify-content-center">
      <div class="booking-form">
        <h1>New Booking</h1>
        <%= simple_form_for [@pet, @booking] do |f| %>
          <%= f.input :start_date, as: :string, input_html: { type: 'date' } %>
          <%= f.input :end_date, as: :string, input_html: { type: 'date' } %>
          <%= f.submit "Book", class: "btn btn-success" %>
        <% end %>
      </div>
    </div>

  <% end %>
  <% else %>
    <div class="alert alert-dismissible fade show">
      <strong><i class="fa-solid fa-triangle-exclamation"></i></strong> You should log in to book it.
    </div>
  <% end %>
